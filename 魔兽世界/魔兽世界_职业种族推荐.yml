app:
  description: åŸºäºé­”å…½ä¸–ç•Œå®˜ç½‘æ•°æ®æä¾›çš„è§’è‰²æ‰®æ¼”å¯¹è¯å¼èŒä¸šç§æ—æ¨èå·¥å…·
  icon: ğŸ¤–
  icon_background: '#FFEAD5'
  mode: advanced-chat
  name: é­”å…½ä¸–ç•Œ_èŒä¸šç§æ—æ¨è
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/deepseek:0.0.9@8cc65e3d2ce11b03d377ee008dc699c7016601c2646a09c983fcf7c1fd7827ee
    version: null
kind: app
version: 0.5.0
workflow:
  conversation_variables:
  - description: é’ˆå¯¹å¼€åœºç™½çš„å›å¤æŒ‡å¯¼
    id: 29114428-6d33-4eac-93f3-552e9efe1e72
    name: first_response_guideline
    selector:
    - conversation
    - first_response_guideline
    value: ''
    value_type: string
  - description: å¼€åœºç™½
    id: 74d6e528-ffd7-414a-b017-43927061a537
    name: first_question
    selector:
    - conversation
    - first_question
    value: ''
    value_type: string
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: 'ï¼ˆé…’é¦†è€æ¿æ”¾ä¸‹æ‰‹ä¸­æ“¦æ‹­çš„é…’æ¯ï¼Œé—¨ä¸Šçš„é“ƒé“›å£°éšç€ä½ çš„è¸å…¥è½»è½»å“èµ·ã€‚ä»–æŠ¬å¤´æ‰“é‡ç€ä½ ä»é—¨å£èµ°æ¥ï¼Œé´å­è¸©åœ¨æœ¨åœ°æ¿ä¸Šå‘å‡ºè½»å¾®çš„å±å‘€å£°ï¼Œç›´åˆ°ä½ åœ¨å§å°å‰åä¸‹ã€‚é…’é¦†é‡Œå¼¥æ¼«ç€éº¦é…’å’Œçƒ¤è‚‰é¦™æ°”ï¼Œæ¸©æš–çš„ç‚‰ç«åœ¨è§’è½å™¼å•ªä½œå“ï¼Œå‡ ä¸ªçŸ®äººæ­£ä½å£°äº¤è°ˆã€‚è€æ¿éœ²å‡ºä¸€æŠ¹å‹å¥½çš„ç¬‘å®¹ï¼Œèº«ä½“å¾®å¾®å‰å€¾ï¼Œæ‰‹è‚˜æ’‘åœ¨å§å°ä¸Šã€‚ï¼‰

      é…’é¦†è€æ¿ï¼šâ€œå•Šï¼Œä¸€ä½è¿œé“è€Œæ¥çš„å®¢äººï¼çœ‹ä½ é£å°˜ä»†ä»†çš„æ ·å­ï¼Œæ˜¯ä»è’éƒŠé‡å²­çš„æ—§è·¯èµ¶æ¥ï¼Œè¿˜æ˜¯ä¹˜èˆ¹è·¨è¿‡æ— å°½ä¹‹æµ·ï¼Ÿæˆ‘æ˜¯è¿™çš„è€æ¿ã€‚åå§ï¼Œåˆ«æ‹˜æŸâ€”â€”è¿™å„¿çš„é…’èƒ½æ´—å»ä¸€èº«ç–²æƒ«ã€‚ä¸è¿‡è¯è¯´å›æ¥ï¼Œæˆ‘è§è¿‡æ— æ•°åƒä½ è¿™æ ·çš„å†’é™©è€…ï¼Œæ¯ä¸ªäººéƒ½æœ‰è‡ªå·±çš„æ•…äº‹å’Œé“è·¯â€¦â€¦å‘Šè¯‰æˆ‘ï¼Œæ˜¯ä»€ä¹ˆé£æŠŠä½ å¹åˆ°è¿™é…’é¦†æ¥çš„ï¼Ÿæ˜¯å•çº¯æƒ³å–ä¸€æ¯æš–æš–èº«å­ï¼Œè¿˜æ˜¯å¿ƒé‡Œæ—©æœ‰äº†äº›æ¨¡ç³Šçš„å¿µå¤´ï¼Œæƒ³åœ¨è¿™å¹¿é˜”ä¸–ç•Œé‡Œæ‰¾ä¸ªå±äºè‡ªå·±çš„ä½ç½®ï¼Ÿâ€'
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        sourceType: llm
        targetType: answer
      id: llm-answer
      selected: false
      source: llm
      sourceHandle: source
      target: answer
      targetHandle: target
      type: custom
    - data:
        isInLoop: false
        sourceType: llm
        targetType: knowledge-retrieval
      id: 1770122768993-source-1770119206846-target
      selected: false
      source: '1770122768993'
      sourceHandle: source
      target: '1770119206846'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: question-classifier
        targetType: llm
      id: 1770379526302-2-1770380223078-target
      selected: false
      source: '1770379526302'
      sourceHandle: '2'
      target: '1770380223078'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: knowledge-retrieval
      id: 1770380223078-source-17703806152700-target
      selected: false
      source: '1770380223078'
      sourceHandle: source
      target: '17703806152700'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: knowledge-retrieval
        targetType: llm
      id: 17703806152700-source-17703806754120-target
      selected: false
      source: '17703806152700'
      sourceHandle: source
      target: '17703806754120'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: answer
      id: 17703806754120-source-answer-target
      selected: false
      source: '17703806754120'
      sourceHandle: source
      target: answer
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: assigner
      id: 1770574037546-true-1770575052659-target
      selected: false
      source: '1770574037546'
      sourceHandle: 'true'
      target: '1770575052659'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: question-classifier
        targetType: llm
      id: 1770379526302-1-1770122768993-target
      selected: false
      source: '1770379526302'
      sourceHandle: '1'
      target: '1770122768993'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: knowledge-retrieval
        targetType: llm
      id: 1770119206846-source-llm-target
      selected: false
      source: '1770119206846'
      sourceHandle: source
      target: llm
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: start
        targetType: if-else
      id: 1770118607248-source-1770574037546-target
      selected: false
      source: '1770118607248'
      sourceHandle: source
      target: '1770574037546'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: if-else
        targetType: assigner
      id: 1770574037546-true-1770575683326-target
      selected: false
      source: '1770574037546'
      sourceHandle: 'true'
      target: '1770575683326'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: if-else
        targetType: assigner
      id: 1770574037546-false-1770575919957-target
      selected: false
      source: '1770574037546'
      sourceHandle: 'false'
      target: '1770575919957'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: if-else
        targetType: assigner
      id: 1770574037546-false-1770575925535-target
      selected: false
      source: '1770574037546'
      sourceHandle: 'false'
      target: '1770575925535'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: assigner
        targetType: llm
      id: 1770575052659-source-1770610310240-target
      selected: false
      source: '1770575052659'
      sourceHandle: source
      target: '1770610310240'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: assigner
        targetType: llm
      id: 1770575683326-source-1770610310240-target
      selected: false
      source: '1770575683326'
      sourceHandle: source
      target: '1770610310240'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: assigner
        targetType: llm
      id: 1770575919957-source-1770610310240-target
      selected: false
      source: '1770575919957'
      sourceHandle: source
      target: '1770610310240'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: assigner
        targetType: llm
      id: 1770575925535-source-1770610310240-target
      selected: false
      source: '1770575925535'
      sourceHandle: source
      target: '1770610310240'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: if-else
      id: 1770610310240-source-1770610321141-target
      selected: false
      source: '1770610310240'
      sourceHandle: source
      target: '1770610321141'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: answer
      id: 1770610321141-0647f5c3-565d-4951-aee9-852e98019595-1770179245235-target
      selected: false
      source: '1770610321141'
      sourceHandle: 0647f5c3-565d-4951-aee9-852e98019595
      target: '1770179245235'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: if-else
      id: 1770610321141-7fa871ef-a7c7-4ac1-9886-ae2db67212f7-17706126656860-target
      selected: false
      source: '1770610321141'
      sourceHandle: 7fa871ef-a7c7-4ac1-9886-ae2db67212f7
      target: '17706126656860'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: answer
      id: 17706126656860-true-1770179245235-target
      selected: false
      source: '17706126656860'
      sourceHandle: 'true'
      target: '1770179245235'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: if-else
        targetType: if-else
      id: 1770610321141-true-1770613283393-target
      source: '1770610321141'
      sourceHandle: 'true'
      target: '1770613283393'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: question-classifier
      id: 1770613283393-629f0e20-3f39-424b-8efc-30daf31904ca-1770379526302-target
      source: '1770613283393'
      sourceHandle: 629f0e20-3f39-424b-8efc-30daf31904ca
      target: '1770379526302'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: if-else
      id: 1770613283393-true-17706126656860-target
      source: '1770613283393'
      sourceHandle: 'true'
      target: '17706126656860'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: if-else
        targetType: llm
      id: 17706126656860-false-1770614274780-target
      source: '17706126656860'
      sourceHandle: 'false'
      target: '1770614274780'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: answer
      id: 1770614274780-source-answer-target
      source: '1770614274780'
      sourceHandle: source
      target: answer
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        selected: false
        title: ç”¨æˆ·è¾“å…¥
        type: start
        variables: []
      height: 73
      id: '1770118607248'
      position:
        x: 0
        y: 148
      positionAbsolute:
        x: 0
        y: 148
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        context:
          enabled: true
          variable_selector:
          - '1770119206846'
          - result
        memory:
          query_prompt_template: '{{#sys.query#}}'
          role_prefix:
            assistant: ''
            user: ''
          window:
            enabled: true
            size: 20
        model:
          completion_params: {}
          mode: chat
          name: deepseek-reasoner
          provider: langgenius/deepseek/deepseek
        prompt_config:
          jinja2_variables: []
        prompt_template:
        - edition_type: basic
          id: 2b37e594-98ab-402c-9449-8773f0ef5460
          jinja2_text: ''
          role: system
          text: '<system_purpose>

            ä½ æ˜¯ä¸€ä¸ªã€Šé­”å…½ä¸–ç•Œã€‹ä¸–ç•Œè§‚ä¸‹çš„æ‰®æ¼”é…’é¦†è€æ¿ã€‚

            </system_purpose>



            <character_setting>

            - èº«ä»½ï¼šè‰¾æ³½æ‹‰æ–¯å¤§é™†æŸå¤„æ¸©æƒ…é…’é¦†çš„è€æ¿ã€‚

            - è¯­æ°”ï¼šäº²åˆ‡ã€ç¿æ™ºã€å¸¦æœ‰å†’é™©æ°”æ¯ï¼Œå¤šç”¨å£è¯­åŒ–çš„è§’è‰²æ‰®æ¼”æè¿°ã€‚

            </character_setting>



            <task_rules>

            - æ ¸å¿ƒä»»åŠ¡ï¼šæ ¹æ® <knowledge_base> ä¸­çš„ä¿¡æ¯ï¼Œé€šè¿‡å¯¹è¯å¼•å¯¼ç©å®¶é€‰æ‹©èŒä¸šå’Œç§æ—ã€‚

            - å¼•å¯¼è§„åˆ™ï¼š

            Â  1. è€ƒå¯Ÿç‚¹ï¼šå–„æ¶è§‚ã€åŠ›é‡å€¾å‘ï¼ˆé­”æ³•/ç‰©ç†ï¼‰ã€ä½œæˆ˜è·ç¦»ï¼ˆè¿‘æˆ˜/è¿œç¨‹ï¼‰ã€èŒè´£ï¼ˆå¦å…‹/æ²»ç–—/è¾“å‡ºï¼‰ã€æ­¦å™¨ç­‰ã€‚

            Â  2. å½¢å¼ï¼šæ¯æ¬¡å¯¹è¯ä»…æå‡º 2-4 ä¸ªé—®é¢˜ï¼Œä¸¥ç¦ä½¿ç”¨ç¼–å·åˆ—è¡¨ï¼ˆå¦‚ 1. 2. 3.ï¼‰ã€‚

            Â  3. é™åˆ¶ï¼š20 è½®å¯¹è¯å†…å¿…é¡»ç»™å‡ºæ˜ç¡®å»ºè®®ã€å»ºè®®çš„èŒä¸šå’Œç§æ—å¿…é¡»æ˜¯é­”å…½ä¸–ç•Œä¸­ç©å®¶å¯é€‰æ‹©ï¼›å®Œæˆæ¨èå‰ä¸¥ç¦é€éœ²ä»»ä½•å€¾å‘æ€§ç»“è®ºï¼›ç¦æ­¢ä½¿ç”¨æ¸¸æˆæœ¯è¯­ã€‚

            </task_rules>



            <knowledge_base>

            {{#1770119206846.result#}}

            </knowledge_base>


            {{#conversation.first_question#}}


            {{#conversation.first_response_guideline#}}'
        selected: false
        title: ä¸»è¦å›å¤é€»è¾‘
        type: llm
        vision:
          enabled: false
      height: 88
      id: llm
      position:
        x: 3178
        y: 683
      positionAbsolute:
        x: 3178
        y: 683
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        answer: '{{#llm.text#}}

          {{#17703806754120.text#}}

          {{#1770614274780.text#}}'
        selected: false
        title: æœ€ç»ˆå›å¤
        type: answer
        variables: []
      height: 141
      id: answer
      position:
        x: 3540
        y: 486
      positionAbsolute:
        x: 3540
        y: 486
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        dataset_ids:
        - hK9chCbrtmWQKT7Tgj593kGCGzbxMYdlJ9n2y9pNerhLIQl9Lx1+AQm0fh2/a3tB
        metadata_filtering_mode: automatic
        metadata_model_config:
          completion_params:
            response_format: json_object
            temperature: 0.7
          mode: chat
          name: deepseek-chat
          provider: langgenius/deepseek/deepseek
        multiple_retrieval_config:
          reranking_enable: false
          reranking_mode: reranking_model
          top_k: 4
        query_attachment_selector: []
        query_variable_selector:
        - '1770122768993'
        - text
        retrieval_mode: multiple
        selected: false
        title: çŸ¥è¯†æ£€ç´¢
        type: knowledge-retrieval
      height: 90
      id: '1770119206846'
      position:
        x: 2836
        y: 682
      positionAbsolute:
        x: 2836
        y: 682
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        context:
          enabled: false
          variable_selector: []
        memory:
          query_prompt_template: '{{#sys.query#}}'
          role_prefix:
            assistant: ''
            user: ''
          window:
            enabled: false
            size: 50
        model:
          completion_params:
            response_format: json_object
          mode: chat
          name: deepseek-chat
          provider: langgenius/deepseek/deepseek
        prompt_template:
        - id: 1c4f1bf1-69be-4e5c-b8f2-7e6cd1973626
          role: system
          text: "Â  Â  # ä»»åŠ¡\nÂ  Â  æ ¹æ®ç”¨æˆ·å¯¹è¯å†…å®¹ï¼Œç”ŸæˆçŸ¥è¯†åº“æ£€ç´¢æ¡ä»¶\nÂ  Â  \nÂ  Â  # è¾“å…¥åˆ†æ\nÂ  Â  1. æå–å…³é”®è¯ï¼šä»å¯¹è¯ä¸­æå–èŒä¸šã€ç§æ—ã€ç‰¹æ€§ç›¸å…³è¯æ±‡\n\
            Â  Â  2. è¯†åˆ«æ„å›¾ï¼šåˆ¤æ–­ç”¨æˆ·å½“å‰è®¨è®ºçš„ä¸»é¢˜é˜¶æ®µ\nÂ  Â  3. æ¨æ–­éœ€æ±‚ï¼šåŸºäºå¯¹è¯å†å²æ¨æµ‹å¯èƒ½éœ€è¦çš„èƒŒæ™¯çŸ¥è¯†\nÂ  Â  \nÂ  Â  #\
            \ è¾“å‡ºæ ¼å¼\nJSONæ ¼å¼\nÂ  Â  {\nÂ  Â  Â  \"query_conditions\": [\"å…³é”®è¯1\", \"å…³é”®è¯2\"\
            , \"åŒä¹‰è¯\"],\nÂ  Â  Â  \"query_type\": \"èŒä¸šç‰¹æ€§|ç§æ—æ–‡åŒ–|å†å²èƒŒæ™¯|èŒä¸šå¯¹æ¯”\",\nÂ  Â  Â  \"\
            query_context\": \"ç®€è¦è¯´æ˜å½“å‰å¯¹è¯é˜¶æ®µå’Œä¸Šä¸‹æ–‡\"\nÂ  Â  }\nÂ  Â  \nÂ  Â  # ç¤ºä¾‹\nÂ  Â  ç”¨æˆ·è¯´ï¼š\"\
            æˆ‘æ›´å–œæ¬¢ç”¨é­”æ³•è§£å†³é—®é¢˜\"\nÂ  Â  è¾“å‡ºï¼š\nÂ  Â  {\nÂ  Â  Â  \"query_conditions\": [\"é­”æ³•èŒä¸š\",\
            \ \"æ³•å¸ˆ\", \"æœ¯å£«\", \"ç‰§å¸ˆ\", \"é­”æ³•å¤©èµ‹\"],\nÂ  Â  Â  \"query_type\": \"èŒä¸šç‰¹æ€§\",\n\
            Â  Â  Â  \"query_context\": \"ç”¨æˆ·åœ¨è¡¨è¾¾æˆ˜æ–—åå¥½ï¼Œå€¾å‘äºæ–½æ³•è€…\"\nÂ  Â  }"
        selected: false
        title: çŸ¥è¯†æ£€ç´¢é¢„å¤„ç†
        type: llm
        vision:
          enabled: false
      height: 88
      id: '1770122768993'
      position:
        x: 2494
        y: 683
      positionAbsolute:
        x: 2494
        y: 683
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        answer: "ï¼ˆè€æ¿æ”¾ä¸‹é…’æ¯ï¼Œè®¤çœŸåœ°çœ‹ç€ä½ ï¼‰\n  \n  å•Šï¼Œçœ‹æ¥ä½ å¿ƒé‡Œå·²ç»æœ‰äº†æ˜ç¡®çš„å¿µå¤´ï¼åœ¨è¿™ç‰‡å¹¿é˜”çš„åœŸåœ°ä¸Šï¼Œæ¯ä¸ªå†’é™©è€…éƒ½æœ‰è‡ªå·±çš„é“è·¯è¦é—¯ã€‚æ—¢ç„¶ä½ å·²ç»æœ‰äº†æ–¹å‘ï¼Œæˆ‘å°±ä¸å¤šå¨æ‰°äº†ã€‚\n\
          \  \n  ä¸è¿‡è®°ä½ï¼Œä¼™è®¡ï¼šåŠ›é‡çš„å¼ºå¼±ä¼šéšé£äº‘å˜å¹»ï¼Œä½†çœŸæ­£å¡‘é€ ä¼ å¥‡çš„ï¼Œæ˜¯ä¸€é¢—åšå®šçš„å¿ƒã€‚æ— è®ºä½ é€‰æ‹©ä»€ä¹ˆé“è·¯ï¼Œéƒ½å‹‡æ•¢åœ°èµ°ä¸‹å»å§ï¼"
        selected: false
        title: æ— RPæ„æ„¿å›å¤
        type: answer
        variables: []
      height: 212
      id: '1770179245235'
      position:
        x: 2494
        y: 126
      positionAbsolute:
        x: 2494
        y: 126
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        classes:
        - id: '1'
          name: 'ç‰¹å¾ï¼š

            - é¡ºç€é…’é¦†è€æ¿çš„è¯é¢˜è¿›è¡Œå›åº”ã€‚

            - ç”¨æˆ·ç»™å‡ºè¿‡å­˜åœ¨å€¾å‘æ€§çš„ç­”æ¡ˆã€‚

            - ç”¨æˆ·æœªå¦è®¤å…¨éƒ¨é€»è¾‘ä¸é—®é¢˜ã€‚'
        - id: '2'
          name: 'ç‰¹å¾ï¼š

            - ç”¨æˆ·å¦è®¤äº†ä¸€åˆ‡é€»è¾‘ä¸é—®é¢˜ã€‚

            - ç”¨æˆ·æœªç»™å‡ºä»»ä½•å­˜åœ¨å€¾å‘æ€§çš„ç­”æ¡ˆã€‚'
        instruction: '# åˆ†ç±»ä»»åŠ¡

          ç»¼åˆä¸Šä¸‹æ–‡å’Œç”¨æˆ·è¾“å…¥åˆ¤æ–­ç”¨æˆ·æ„å›¾


          {{#conversation.first_question#}}


          # ç”¨æˆ·è¾“å…¥

          {{#sys.query#}}

          '
        instructions: ''
        memory:
          query_prompt_template: '{{#sys.query#}}


            {{#sys.files#}}'
          window:
            enabled: true
            size: 20
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: deepseek-chat
          provider: langgenius/deepseek/deepseek
        query_variable_selector:
        - sys
        - query
        selected: false
        title: åˆ¤æ–­æ˜¯å¦åœ¨è¯é¢˜é€»è¾‘å†…å¯¹è¯
        type: question-classifier
        vision:
          enabled: false
      height: 170
      id: '1770379526302'
      position:
        x: 2132
        y: 500
      positionAbsolute:
        x: 2132
        y: 500
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        context:
          enabled: true
          variable_selector:
          - sys
          - query
        memory:
          query_prompt_template: '{{#sys.query#}}'
          role_prefix:
            assistant: ''
            user: ''
          window:
            enabled: true
            size: 20
        model:
          completion_params: {}
          mode: chat
          name: deepseek-reasoner
          provider: langgenius/deepseek/deepseek
        prompt_template:
        - id: c88f86e3-ce08-453b-97b2-78f1e5a5e154
          role: system
          text: "    # è§’è‰²\n    ä½ æ˜¯ä¸€ä¸ªæ„å›¾è§£é‡Šå™¨\n\n    # èƒŒæ™¯\n    åˆ°è¾¾æ­¤èŠ‚ç‚¹è¯´æ˜ç”¨æˆ·åœ¨å‰ç½®å¯¹è¯ä¸­ç”¨æˆ·å¦è®¤äº†ä¸€åˆ‡é€»è¾‘ä¸é—®é¢˜ï¼Œæˆ–æœªç»™å‡ºä»»ä½•å­˜åœ¨å€¾å‘æ€§çš„ç­”æ¡ˆã€‚\n\
            \nÂ  Â  # ä»»åŠ¡\nÂ  Â  æ ¹æ®ç”¨æˆ·å¯¹è¯å†…å®¹å’Œä¸Šä¸‹æ–‡ï¼Œç”ŸæˆçŸ¥è¯†åº“æ£€ç´¢æ¡ä»¶\nÂ  Â  \nÂ  Â  # è¾“å…¥åˆ†æ\nÂ  Â  1. æå–å…³é”®è¯ï¼šä»å¯¹è¯ä¸­æå–èŒä¸šã€ç§æ—ã€ç‰¹æ€§ç›¸å…³è¯æ±‡\n\
            Â  Â  2. è¯†åˆ«æ„å›¾ï¼šåˆ¤æ–­ç”¨æˆ·å½“å‰è®¨è®ºçš„ä¸»é¢˜é˜¶æ®µ\nÂ  Â  3. æ¨æ–­éœ€æ±‚ï¼šåŸºäºå¯¹è¯å†å²æ¨æµ‹å¯èƒ½éœ€è¦çš„èƒŒæ™¯çŸ¥è¯†\n\nÂ  Â  # é™åˆ¶\n\
            \    1. ç¦æ­¢è¾“å‡ºæ–‡å­—æç¤ºå’Œä»»ä½•markdownæ ‡è¯†\n\nÂ  Â  # è¾“å‡ºæ ¼å¼\nJSONæ ¼å¼\nÂ  Â  {\nÂ  Â  Â  \"query_conditions\"\
            : [\"å…³é”®è¯1\", \"å…³é”®è¯2\", \"åŒä¹‰è¯\"],\nÂ  Â  Â  \"query_type\": \"èŒä¸šç‰¹æ€§|ç§æ—æ–‡åŒ–|å†å²èƒŒæ™¯|èŒä¸šå¯¹æ¯”\"\
            ,\nÂ  Â  Â  \"query_context\": \"ç®€è¦è¯´æ˜å½“å‰å¯¹è¯é˜¶æ®µå’Œä¸Šä¸‹æ–‡\"\nÂ  Â  }\nÂ  Â  \nÂ  Â  # ç¤ºä¾‹\n\
            Â  Â  ç”¨æˆ·è¯´ï¼š\"æˆ‘æ›´å–œæ¬¢ç”¨é­”æ³•è§£å†³é—®é¢˜\"\nÂ  Â  è¾“å‡ºï¼š\nÂ  Â  {\nÂ  Â  Â  \"query_conditions\": [\"\
            é­”æ³•èŒä¸š\", \"æ³•å¸ˆ\", \"æœ¯å£«\", \"ç‰§å¸ˆ\", \"é­”æ³•å¤©èµ‹\"],\nÂ  Â  Â  \"query_type\": \"èŒä¸šç‰¹æ€§\"\
            ,\nÂ  Â  Â  \"query_context\": \"ç”¨æˆ·åœ¨è¡¨è¾¾æˆ˜æ–—åå¥½ï¼Œå€¾å‘äºæ–½æ³•è€…\"\nÂ  Â  }"
        - id: 629d8357-6479-4a7f-abe8-29ef6f8bd50b
          role: user
          text: '{{#sys.query#}}'
        reasoning_format: separated
        selected: false
        title: çŸ¥è¯†æ£€ç´¢é¢„å¤„ç†-æ— å€¾å‘æ€§æ‰©å±•æŸ¥è¯¢
        type: llm
        vision:
          enabled: false
      height: 88
      id: '1770380223078'
      position:
        x: 2494
        y: 513
      positionAbsolute:
        x: 2494
        y: 513
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        dataset_ids:
        - hK9chCbrtmWQKT7Tgj593kGCGzbxMYdlJ9n2y9pNerhLIQl9Lx1+AQm0fh2/a3tB
        metadata_filtering_mode: automatic
        metadata_model_config:
          completion_params:
            response_format: json_object
            temperature: 0.7
          mode: chat
          name: deepseek-chat
          provider: langgenius/deepseek/deepseek
        multiple_retrieval_config:
          reranking_enable: false
          reranking_mode: reranking_model
          top_k: 4
        query_attachment_selector: []
        query_variable_selector:
        - '1770380223078'
        - text
        retrieval_mode: multiple
        selected: false
        title: çŸ¥è¯†æ£€ç´¢-æ— å€¾å‘æ€§èŠ‚ç‚¹
        type: knowledge-retrieval
      height: 90
      id: '17703806152700'
      position:
        x: 2836
        y: 512
      positionAbsolute:
        x: 2836
        y: 512
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        context:
          enabled: true
          variable_selector:
          - '17703806152700'
          - result
        memory:
          query_prompt_template: '{{#sys.query#}}


            '
          role_prefix:
            assistant: ''
            user: ''
          window:
            enabled: true
            size: 20
        model:
          completion_params: {}
          mode: chat
          name: deepseek-reasoner
          provider: langgenius/deepseek/deepseek
        prompt_config:
          jinja2_variables: []
        prompt_template:
        - edition_type: basic
          id: 2b37e594-98ab-402c-9449-8773f0ef5460
          jinja2_text: ''
          role: system
          text: "<system_purpose>\nä½ æ˜¯ä¸€ä¸ªã€Šé­”å…½ä¸–ç•Œã€‹ä¸–ç•Œè§‚ä¸‹çš„æ‰®æ¼”é…’é¦†è€æ¿ã€‚\n</system_purpose>\n\n\n\
            <character_setting>\n- èº«ä»½ï¼šè‰¾æ³½æ‹‰æ–¯å¤§é™†æŸå¤„æ¸©æƒ…é…’é¦†çš„è€æ¿ã€‚\n- è¯­æ°”ï¼šäº²åˆ‡ã€ç¿æ™ºã€å¸¦æœ‰å†’é™©æ°”æ¯ï¼Œå¤šç”¨å£è¯­åŒ–çš„è§’è‰²æ‰®æ¼”æè¿°ã€‚\n\
            </character_setting>\n\n\n<task_rules>\n- æ ¸å¿ƒä»»åŠ¡ï¼šæ ¹æ® <knowledge_base> ä¸­çš„ä¿¡æ¯ï¼Œé€šè¿‡å¯¹è¯å¼•å¯¼ç©å®¶é€‰æ‹©èŒä¸šå’Œç§æ—ã€‚\n\
            - å¼•å¯¼è§„åˆ™ï¼š\nÂ  1. è€ƒå¯Ÿç‚¹ï¼šå–„æ¶è§‚ã€åŠ›é‡å€¾å‘ï¼ˆé­”æ³•/ç‰©ç†ï¼‰ã€ä½œæˆ˜è·ç¦»ï¼ˆè¿‘æˆ˜/è¿œç¨‹ï¼‰ã€èŒè´£ï¼ˆå¦å…‹/æ²»ç–—/è¾“å‡ºï¼‰ã€æ­¦å™¨ç­‰ã€‚\nÂ  2.\
            \ å½¢å¼ï¼šæ¯æ¬¡å¯¹è¯ä»…æå‡º 2-4 ä¸ªé—®é¢˜ï¼Œä¸¥ç¦ä½¿ç”¨ç¼–å·åˆ—è¡¨ï¼ˆå¦‚ 1. 2. 3.ï¼‰ã€‚\nÂ  3. é™åˆ¶ï¼š20 è½®å¯¹è¯å†…å¿…é¡»ç»™å‡ºæ˜ç¡®å»ºè®®ã€å»ºè®®çš„èŒä¸šå’Œç§æ—å¿…é¡»æ˜¯é­”å…½ä¸–ç•Œä¸­ç©å®¶å¯é€‰æ‹©ï¼›å®Œæˆæ¨èå‰ä¸¥ç¦é€éœ²ä»»ä½•å€¾å‘æ€§ç»“è®ºï¼›ç¦æ­¢ä½¿ç”¨æ¸¸æˆæœ¯è¯­ã€‚\n\
            </task_rules>\n\n\n<knowledge_base>\n{{#1770380223078.text#}}\n</knowledge_base>\n\
            \n\n<pre_node_analysis>\n    å½“å‰èŠ‚ç‚¹å·²æ¥æ”¶æ¥è‡ª [é—®é¢˜åˆ†ç±»å™¨] çš„è¿‡æ»¤ä¿¡å·ã€‚ å¦‚æœç”¨æˆ·è¡¨ç°å‡ºâ€œæ‹’ç»å›ç­”â€ã€â€œå¦å®šé€»è¾‘â€æˆ–â€œå‹åŠ›æµ‹è¯•â€ï¼Œè¯´æ˜æµç¨‹å·²è¿›å…¥â€œéæ ‡å‡†å¼•å¯¼ç¯èŠ‚â€ã€‚\
            \ </pre_node_analysis>\n\n\n<context_background> \n    <scene_state> \n\
            \        é…’é¦†è€æ¿ï¼ˆä½ ï¼‰å·²ç»å‘å®¢äººï¼ˆç”¨æˆ·ï¼‰å‘å‡ºäº†é‚€è¯·ï¼Œä½†å®¢äººçš„ååº”å¯èƒ½å¹¶ä¸ç§¯æã€‚\n     </scene_state>\n  \
            \   <mission_objective> \n        1. ä¿æŒé…’é¦†è€æ¿çš„äººè®¾ï¼Œæ— è®ºç”¨æˆ·å¦‚ä½•æŒ‘è¡…æˆ–æ‹’ç»ï¼Œä¸å¾—è„±ç¦»è§’è‰²ã€‚ \n\
            \        2. é’ˆå¯¹â€œå¦å®šå›ç­”â€ï¼Œä¸è¦å¼ºè¡Œæ¨è¿›é—®å·ï¼Œè€Œæ˜¯åˆ©ç”¨è§’è‰²èº«ä»½è¿›è¡Œè½¯å¤„ç†ï¼ˆä¾‹å¦‚ï¼šæ„Ÿå¹å®¢äººçš„è°¨æ…ï¼Œæˆ–ç”¨å¹½é»˜åŒ–è§£å°´å°¬ï¼‰ã€‚ \n \
            \       3. ä¸¥ç¦æä¾›å¸¦æœ‰æ•°å€¼å¼ºåº¦çš„â€œæ ‡å‡†ç­”æ¡ˆâ€ï¼Œå³ä½¿è¢«ç”¨æˆ·é€¼é—®ï¼Œä¹Ÿè¦ä»¥â€œæ¯ä¸ªäººçœ¼ä¸­çš„å¼ºå¼±ä¸åŒâ€ä¸ºç”±åŒ–è§£ã€‚ \n     </mission_objective>\
            \ \n</context_background> \n<handling_strategies> \n    <on_negation>\n\
            \        å½“ç”¨æˆ·å¦å®šæˆ–æ‹’ç»æ—¶ï¼Œé…’é¦†è€æ¿åº”è¡¨ç°å‡ºåŒ…å®¹ï¼Œå¯ä»¥èŠèŠé…’é¦†é‡Œçš„ä¼ é—»ï¼Œæˆ–è€…æ¢ä¸€ç§æ›´å§”å©‰çš„åˆ‡å…¥ç‚¹ã€‚\n    </on_negation>\
            \ \n    <on_bias_test>\n        å½“ç”¨æˆ·æµ‹è¯•å€¾å‘æ€§æ—¶ï¼Œå¼ºè°ƒâ€œå‘½è¿æŒæ¡åœ¨ä½ è‡ªå·±æ‰‹é‡Œï¼Œæˆ‘åªæ˜¯ä¸ªå€’é…’çš„â€ã€‚\n  \
            \  </on_bias_test>\n</handling_strategies>\n\n{{#conversation.first_question#}}\n\
            \n{{#conversation.first_response_guideline#}}"
        selected: false
        title: ä¸»è¦å›å¤é€»è¾‘-æ— å€¾å‘æ€§èŠ‚ç‚¹
        type: llm
        vision:
          enabled: false
      height: 88
      id: '17703806754120'
      position:
        x: 3178
        y: 513
      positionAbsolute:
        x: 3178
        y: 513
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: '='
            id: e299bfee-87dc-4df7-a01f-4d7126e6669f
            value: '1'
            varType: number
            variable_selector:
            - sys
            - dialogue_count
          id: 'true'
          logical_operator: and
        selected: false
        title: ç¬¬ä¸€è½®å¯¹è¯åˆ¤æ–­
        type: if-else
      height: 124
      id: '1770574037546'
      position:
        x: 342
        y: 123
      positionAbsolute:
        x: 342
        y: 123
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        items:
        - input_type: constant
          operation: set
          value: '<context>

            <salutatory_oration>

            é…’é¦†è€æ¿ï¼šâ€œå•Šï¼Œä¸€ä½è¿œé“è€Œæ¥çš„å®¢äººï¼çœ‹ä½ é£å°˜ä»†ä»†çš„æ ·å­ï¼Œæ˜¯ä»è’éƒŠé‡å²­çš„æ—§è·¯èµ¶æ¥ï¼Œè¿˜æ˜¯ä¹˜èˆ¹è·¨è¿‡æ— å°½ä¹‹æµ·ï¼Ÿæˆ‘æ˜¯è¿™çš„è€æ¿ã€‚åå§ï¼Œåˆ«æ‹˜æŸâ€”â€”è¿™å„¿çš„é…’èƒ½æ´—å»ä¸€èº«ç–²æƒ«ã€‚ä¸è¿‡è¯è¯´å›æ¥ï¼Œæˆ‘è§è¿‡æ— æ•°åƒä½ è¿™æ ·çš„å†’é™©è€…ï¼Œæ¯ä¸ªäººéƒ½æœ‰è‡ªå·±çš„æ•…äº‹å’Œé“è·¯â€¦â€¦å‘Šè¯‰æˆ‘ï¼Œæ˜¯ä»€ä¹ˆé£æŠŠä½ å¹åˆ°è¿™é…’é¦†æ¥çš„ï¼Ÿæ˜¯å•çº¯æƒ³å–ä¸€æ¯æš–æš–èº«å­ï¼Œè¿˜æ˜¯å¿ƒé‡Œæ—©æœ‰äº†äº›æ¨¡ç³Šçš„å¿µå¤´ï¼Œæƒ³åœ¨è¿™å¹¿é˜”ä¸–ç•Œé‡Œæ‰¾ä¸ªå±äºè‡ªå·±çš„ä½ç½®ï¼Ÿâ€

            </salutatory_oration>

            </context>'
          variable_selector:
          - conversation
          - first_question
          write_mode: over-write
        selected: false
        title: è®¾å®šå¼€åœºç™½
        type: assigner
        version: '2'
      height: 84
      id: '1770575052659'
      position:
        x: 704
        y: 0
      positionAbsolute:
        x: 704
        y: 0
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        items:
        - input_type: constant
          operation: set
          value: '<response_guideline>

            Â  Â  - å¦‚æœç©å®¶çš„å›å¤æ˜¯é’ˆå¯¹æ¬¢è¿è¯çš„ï¼ˆä¾‹å¦‚â€œæˆ‘æƒ³æ‰¾ä¸ªèŒä¸šâ€ï¼‰ï¼Œè¯·ç«‹åˆ»è¿›å…¥èŒä¸šè¯¢é—®çš„ç¬¬ä¸€æ­¥ã€‚

            Â  Â  - ä¸¥ç¦é‡å¤å¼€åœºç™½çš„å†…å®¹ï¼Œç›´æ¥ä»å¯¹è¯çš„ç¬¬äºŒé˜¶æ®µå¼€å§‹ã€‚

            </response_guideline>'
          variable_selector:
          - conversation
          - first_response_guideline
          write_mode: over-write
        selected: false
        title: è®¾å®šå¼€åœºç™½å›å¤æŒ‡å¯¼
        type: assigner
        version: '2'
      height: 84
      id: '1770575683326'
      position:
        x: 704
        y: 164
      positionAbsolute:
        x: 704
        y: 164
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        items:
        - input_type: variable
          operation: clear
          value: ''
          variable_selector:
          - conversation
          - first_question
          write_mode: over-write
        selected: false
        title: æ¸…ç©ºå¼€åœºç™½
        type: assigner
        version: '2'
      height: 84
      id: '1770575919957'
      position:
        x: 704
        y: 328
      positionAbsolute:
        x: 704
        y: 328
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        items:
        - input_type: variable
          operation: clear
          value: ''
          variable_selector:
          - conversation
          - first_response_guideline
          write_mode: over-write
        selected: false
        title: æ¸…ç©ºå¼€åœºç™½å›å¤æŒ‡å¯¼
        type: assigner
        version: '2'
      height: 84
      id: '1770575925535'
      position:
        x: 704
        y: 492
      positionAbsolute:
        x: 704
        y: 492
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        context:
          enabled: true
          variable_selector:
          - conversation
          - first_question
        memory:
          query_prompt_template: '{{#sys.query#}}'
          role_prefix:
            assistant: ''
            user: ''
          window:
            enabled: true
            size: 4
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: deepseek-chat
          provider: langgenius/deepseek/deepseek
        prompt_template:
        - id: 96e5d0d2-4f1e-48dc-b591-fc0e8e5a330b
          role: system
          text: "# ä»»åŠ¡\n ç»“åˆä¸Šä¸‹æ–‡ï¼Œæ ¹æ®ç”¨æˆ·è¾“å…¥åˆ¤æ–­å¯¹è¯ç±»å‹ \n\n# èƒŒæ™¯\n ä½ æ˜¯ä¸€ä¸ªé…’é¦†è€æ¿ï¼Œæ­£åœ¨å¼•å¯¼æ–°ç©å®¶è¿›å…¥è§’è‰²æ‰®æ¼”ä¸–ç•Œã€‚\n\n\
            # åˆ†ç±»å‚è€ƒæŒ‡æ ‡ (ä»…ä½œä¸ºç½®ä¿¡åº¦è¯„åˆ†çš„å‚è€ƒï¼Œéç¡¬æ€§é™åˆ¶)\n\n## ä¼šæå‡ OOC ç½®ä¿¡åº¦ (å‘ 0.9-1.0 é æ‹¢) çš„ä¿¡å·ï¼š\n-\
            \ å‡ºç°çº¯æ•°æ®æœ¯è¯­ï¼šå¦‚ DPSã€å±æ€§åŠ ç‚¹ã€T0çº§åˆ«ã€ç‰ˆæœ¬ã€æ‰ç‡ã€‚\n- çº¯æŒ‡ä»¤æ“ä½œï¼šå¦‚â€œé‡æ–°å¼€å§‹â€ã€â€œæŸ¥çœ‹åˆ—è¡¨â€ã€â€œé€€å‡ºâ€ã€‚\n\n## ä¼šæå‡\
            \ IC ç½®ä¿¡åº¦ (å‘ 0.1-0.3 é æ‹¢) çš„ä¿¡å·ï¼š\n- å¸¦æœ‰æƒ…æ„Ÿè‰²å½©æˆ–åŠ¨ä½œï¼šå¦‚â€œæˆ‘æƒ³å®ˆæŠ¤â€ã€â€œï¼ˆåä¸‹ï¼‰â€ã€â€œæ¥ä¸€æ¯â€ã€‚\n- è¯¢é—®ä¸–ç•Œè§‚å¸¸è¯†ï¼šå¦‚â€œè¿™å„¿å±é™©å—â€ã€â€œå“ªç§æ­¦å™¨æ›´æ²‰â€ã€‚\n\
            \n## å¤„äºæ¨¡ç³ŠåŒºé—´ (0.5-0.7) çš„å…¸å‹æƒ…å†µï¼š\n- æç®€æ„å‘è¡¨è¾¾ï¼šå¦‚â€œæˆ‘æƒ³ç©æ³•å¸ˆâ€ã€â€œæˆ˜å£«â€ã€â€œåè€…â€ã€‚\n- *å¤„ç†é€»è¾‘*ï¼šæ­¤ç±»æƒ…å†µè™½ç„¶ç¼ºä¹ä¿®é¥°ï¼Œä½†ä»å±äºå‰§æƒ…äº’åŠ¨çš„æ½œåœ¨åˆ†æ”¯ï¼Œåº”ç»™å‡ºä¸­ç­‰ç½®ä¿¡åº¦ï¼Œäº¤ç”±åç»­é€»è¾‘ç¡®è®¤ã€‚\n\
            \n# ç±»å‹\n\n## 1. æ²‰æµ¸å¼è§’è‰²æ‰®æ¼” (IC - In Character)\nç‰¹å¾ï¼š\n- é¡ºç€å‰§æƒ…å›åº”ï¼šé…åˆè€æ¿çš„æé—®ï¼Œæˆ–è¿›è¡Œé…’é¦†åœºæ™¯ä¸‹çš„åŠ¨ä½œã€‚\n\
            - **è§’è‰²å†…å’¨è¯¢**ï¼šåœ¨å‰§æƒ…è¯­å¢ƒä¸‹ï¼Œå‘è€æ¿è¯·æ•™å…³äºæ­¦å™¨ã€èŒä¸šã€ä¸–ç•Œçš„â€œå¸¸è¯†â€æˆ–â€œå»ºè®®â€ã€‚\n- è¡¨è¾¾æ„å‘ï¼šå³ä¾¿åœ¨çº ç»“ï¼Œä¹Ÿæ˜¯ä»¥â€œè§’è‰²â€çš„èº«ä»½åœ¨çº ç»“ã€‚\n\
            - ç¤ºä¾‹ï¼š\n  - â€œæ¥ä¸€æ¯ç”Ÿå•¤ã€‚â€ (åŠ¨ä½œ)\n  - â€œåŒæ–§å’ŒåŒåˆ€å“ªä¸ªç”¨èµ·æ¥æ›´é¡ºæ‰‹ï¼Ÿâ€ (å‘è€æ¿è¯·æ•™ï¼Œè€Œéé—®ç³»ç»Ÿæ•°å€¼)\n  - â€œæˆ‘è¿˜æ²¡æƒ³å¥½ï¼Œè¿™å¤–é¢çš„ä¸–ç•Œå±é™©å—ï¼Ÿâ€\
            \ (å‰§æƒ…äº’åŠ¨)\n\n## 2. ç³»ç»Ÿ/æ•°å€¼å’¨è¯¢ (OOC - Out of Character)\nç‰¹å¾ï¼š\n- **çº¯æ•°å€¼/åº•å±‚é€»è¾‘æŸ¥è¯¢**ï¼šè¯¢é—®å…·ä½“çš„æ•°å€¼ã€ç™¾åˆ†æ¯”ã€æ‰ç‡ã€æ”»ç•¥ã€ç­‰çº§é™åˆ¶ç­‰è§’è‰²ä¸å¯çŸ¥çš„ä¿¡æ¯ã€‚\n\
            - **å…ƒè¯­è¨€å¯¹è¯**ï¼šè®¨è®ºæ¸¸æˆæœ¬èº«ï¼ˆå¦‚ï¼šè¿™æ¸¸æˆæœ‰å‡ ä¸ªç‰ˆæœ¬ï¼Ÿæ€ä¹ˆå­˜æ¡£ï¼Ÿï¼‰ã€‚\n- **æŒ‡ä»¤æ€§æ“ä½œ**ï¼šç›´æ¥è¦æ±‚ä¿®æ”¹å±æ€§æˆ–åˆ‡æ¢ç³»ç»Ÿç•Œé¢ã€‚\n\
            - ç¤ºä¾‹ï¼š\n  - â€œåŒæ–§çš„æ”»å‡»é€Ÿåº¦åŠ æˆæ˜¯å¤šå°‘ï¼Ÿâ€ (æ˜ç¡®è¯¢é—®æ•°å€¼)\n  - â€œå“ªä¸ªèŒä¸šæ˜¯å½“å‰ç‰ˆæœ¬çš„T0ï¼Ÿâ€ (å…ƒè¯­è¨€/æ”»ç•¥)\n  -\
            \ â€œæ‰“å¼€æŠ€èƒ½æ ‘ã€‚â€ (ç³»ç»ŸæŒ‡ä»¤)\n\n## åˆ†ç±»3ï¼šé€»è¾‘ç¡®è®¤ (Logic-Confirm)\n - **ç‰¹å¾**ï¼šå¯¹è€æ¿æé—®çš„ç®€å•é€»è¾‘å›åº”ï¼Œå¦‚â€œæ˜¯â€ã€â€œä¸æ˜¯â€ã€â€œåè€…â€ã€â€œå¯¹çš„â€ã€‚\n\
            \n# é™åˆ¶\n - ç¦æ­¢è¾“å‡ºæ–‡å­—æç¤ºå’Œä»»ä½•markdownæ ‡è¯†\n\n# è¾“å‡º\nè¯·ä»¥jsonæ ¼å¼è¾“å‡ºï¼Œè¾“å‡ºå†…å®¹åŒ…å«å¦‚ä¸‹å­—æ®µï¼š\n - \"\
            category\" å›å¤\"IC\",\"OOC\",\"Logic\"\n - \"reason\" æ ¹æ®ä¸Šä¸‹æ–‡ç®€è¦è¯´æ˜åˆ†ç±»åˆ°è¯¥categoryçš„åŸå› \n\
            - \"confidence\": (float) ç½®ä¿¡åº¦è¯„åˆ†ï¼Œæ ‡å‡†å¦‚ä¸‹ï¼š\n - 0.9-1.0: åŒ…å«çº¯ç³»ç»Ÿè¯æˆ–æåº¦å»è¯­å¢ƒåŒ–çš„æŒ‡ä»¤ã€‚\n\
            \ - 0.7-0.8: è¯­ä¹‰æ¨¡ç³Šä½†åå‘åŠŸèƒ½æ€§æŸ¥è¯¢ï¼Œç¼ºä¹æ‰®æ¼”ä¿®é¥°ã€‚\n - 0.5-0.6: éš¾ä»¥ç•Œå®šï¼Œç”¨æˆ·å¯èƒ½åœ¨å°è¯•äº’åŠ¨ä½†è¡¨è¾¾ç®€çŸ­ã€‚\n\n\
            # è¾“å‡ºç¤ºä¾‹\n{\n\"category\" : \"OOC\",\n\"reason\" : \"ç”¨æˆ·å›å¤äº†'æˆ‘æƒ³ç©æ²»ç–—'ï¼Œè™½ç„¶å±äºèŒä¸šé€‰æ‹©ï¼Œä½†ç¼ºä¹è§’è‰²æ‰®æ¼”ä¿®é¥°ï¼Œå¤„äºæ¨¡ç³Šåœ°å¸¦ã€‚\"\
            ,\n\"confidence\" : 0.5\n}\n\n{{#conversation.first_question#}}"
        selected: false
        structured_output:
          schema:
            additionalProperties: false
            properties:
              category:
                type: string
              confidence:
                type: number
              reason:
                type: string
            required: []
            type: object
        structured_output_enabled: true
        title: ç”¨æˆ·RPæ„æ„¿åˆ†æ
        type: llm
        vision:
          enabled: false
      height: 88
      id: '1770610310240'
      position:
        x: 1066
        y: 171
      positionAbsolute:
        x: 1066
        y: 171
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: is
            id: 3cab80aa-b381-484b-a42d-9adee75552e0
            value: IC
            varType: object
            variable_selector:
            - '1770610310240'
            - structured_output
            - category
          - comparison_operator: is
            id: 9ff7198b-b864-4c61-b313-9f9b6ddd1e4a
            value: Logic
            varType: object
            variable_selector:
            - '1770610310240'
            - structured_output
            - category
          id: 'true'
          logical_operator: or
        - case_id: 7fa871ef-a7c7-4ac1-9886-ae2db67212f7
          conditions:
          - comparison_operator: is
            id: 74fba39f-f4a2-4f0d-b323-79c426d9f7f6
            value: OOC
            varType: object
            variable_selector:
            - '1770610310240'
            - structured_output
            - category
          - comparison_operator: <
            id: 164134f9-846b-41a7-a83a-2b09ac7fe3b1
            value: '0.9'
            varType: number
            variable_selector:
            - '1770610310240'
            - structured_output
            - confidence
          - comparison_operator: â‰¥
            id: 604b5df2-58e0-4259-81c9-6e2fecb683d5
            value: '0.5'
            varType: number
            variable_selector:
            - '1770610310240'
            - structured_output
            - confidence
          id: 7fa871ef-a7c7-4ac1-9886-ae2db67212f7
          logical_operator: and
        - case_id: 0647f5c3-565d-4951-aee9-852e98019595
          conditions:
          - comparison_operator: is
            id: 91c7e9ea-a951-4d2d-84e9-0254389e343e
            value: OOC
            varType: object
            variable_selector:
            - '1770610310240'
            - structured_output
            - category
          - comparison_operator: â‰¥
            id: 2ff722cd-c5d4-44e6-aaba-169e462b36e6
            value: '0.9'
            varType: number
            variable_selector:
            - '1770610310240'
            - structured_output
            - confidence
          id: 0647f5c3-565d-4951-aee9-852e98019595
          logical_operator: and
        selected: false
        title: åˆ¤æ–­ç”¨æˆ·RPæ„æ„¿
        type: if-else
      height: 324
      id: '1770610321141'
      position:
        x: 1408
        y: 53
      positionAbsolute:
        x: 1408
        y: 53
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: '='
            id: e299bfee-87dc-4df7-a01f-4d7126e6669f
            value: '1'
            varType: number
            variable_selector:
            - sys
            - dialogue_count
          id: 'true'
          logical_operator: and
        selected: false
        title: ç¬¬ä¸€è½®å¯¹è¯åˆ¤æ–­-æœªçŸ¥RPæ„æ„¿
        type: if-else
      height: 124
      id: '17706126656860'
      position:
        x: 2132
        y: 289
      positionAbsolute:
        x: 2132
        y: 289
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        cases:
        - case_id: 629f0e20-3f39-424b-8efc-30daf31904ca
          conditions:
          - comparison_operator: â‰¥
            id: 1358de35-2913-4aed-bb76-076551e9aeb2
            value: '0.8'
            varType: number
            variable_selector:
            - '1770610310240'
            - structured_output
            - confidence
          id: 629f0e20-3f39-424b-8efc-30daf31904ca
          logical_operator: and
        - case_id: 'true'
          conditions:
          - comparison_operator: â‰¤
            id: 94a7bac2-7ff9-403e-b735-94fe82c07ba1
            value: '0.6'
            varType: number
            variable_selector:
            - '1770610310240'
            - structured_output
            - confidence
          id: 'true'
          logical_operator: and
        selected: false
        title: IC/Logicç½®ä¿¡åº¦åˆ¤æ–­
        type: if-else
      height: 172
      id: '1770613283393'
      position:
        x: 1770
        y: 335
      positionAbsolute:
        x: 1770
        y: 335
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    - data:
        context:
          enabled: false
          variable_selector: []
        memory:
          query_prompt_template: '{{#sys.query#}}

            '
          role_prefix:
            assistant: ''
            user: ''
          window:
            enabled: true
            size: 20
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: deepseek-chat
          provider: langgenius/deepseek/deepseek
        prompt_template:
        - id: 8bb8ce9d-3d10-471e-b9c8-77263e58cc1b
          role: system
          text: '# è§’è‰²

            ä½ åœ¨æ‰®æ¼”é…’é¦†è€æ¿


            # èƒŒæ™¯

            ç”¨æˆ·åœ¨å¤šè½®å¯¹è¯ä¸‹è¡¨è¾¾å‡ºäº†ä»‹äºIn Characterå’ŒOut of Characterä¸­é—´çš„å›ç­”ã€‚


            # ä»»åŠ¡

            ä½¿ç”¨è§’è‰²æ‰®æ¼”çš„æ–¹å¼ï¼Œæ ¹æ®ä¸Šä¸‹æ–‡ç®€çŸ­åœ°è¯¢é—®ç”¨æˆ·æ˜¯å¦çœŸçš„è¦åšå‡ºè¿™ä¸ªé€‰æ‹©ã€‚


            {{#conversation.first_question#}}

            {{#conversation.first_response_guideline#}}'
        selected: false
        title: æœªçŸ¥æ„æ„¿-ä½Tokenç­”å¤
        type: llm
        vision:
          enabled: false
      height: 88
      id: '1770614274780'
      position:
        x: 2836
        y: 344
      positionAbsolute:
        x: 2836
        y: 344
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 242
    viewport:
      x: 0
      y: 0
      zoom: 0.7
  rag_pipeline_variables: []
